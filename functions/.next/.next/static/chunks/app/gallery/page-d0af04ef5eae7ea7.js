(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{3586:(e,s,t)=>{"use strict";t.d(s,{I:()=>d,db:()=>o,j:()=>c});var l=t(16203),r=t(23915),a=t(35317),i=t(90858);let n=(0,r.Wp)({apiKey:"AIzaSyDLn-Qoqt0XSx9Fr7jdTqXt54rtzboGcUw",authDomain:"pic-share-be97b.firebaseapp.com",projectId:"pic-share-be97b",storageBucket:"pic-share-be97b.firebasestorage.app",messagingSenderId:"717613380259",appId:"1:717613380259:web:bc5443d92ec0ee76b20516",measurementId:"G-L1DP17QLDW"}),d=(0,i.c7)(n),o=(0,a.aU)(n),c=(0,l.xI)(n)},6994:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var l=t(12115),r=t(8731),a=t(35695),i=t(3586);let n=()=>{let[e,s]=(0,r.hD)(i.j),t=(0,a.useRouter)();return(0,l.useEffect)(()=>{let l=null==e?void 0:e.isAnonymous;s||e||!l||t.push("/sign-in")},[e,s,t]),{user:e,loading:s}}},19474:(e,s,t)=>{"use strict";t.d(s,{T:()=>m});var l=t(95155),r=t(62249),a=t(12115),i=t(35317),n=t(3586);let d=async e=>{if(!e)return 0;let s=(0,i.rJ)(n.db,"images",e,"comments");return(await (0,i.GG)(s)).size},o=e=>{let{imageId:s}=e,[t,r]=(0,a.useState)(null),[i,n]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{d(s).then(r),null!==t&&t>1&&n(!0)},[s,t]),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:null!==t?"".concat(t," ").concat(i?"comments":"comment"):"Loading..."})};var c=t(35695),u=t(66766);let m=e=>{let{images:s,showComments:t}=e,a=(0,c.useRouter)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full max-w-5xl px-8 cursor-pointer",children:s.map(e=>(0,l.jsxs)("div",{className:"border p-2 rounded-lg shadow-md mb-8",onClick:()=>a.push("/gallery/".concat(e.id)),children:[(0,l.jsx)("div",{className:"relative w-full h-48 mb-2",children:(0,l.jsx)(u.default,{src:e.imageUrl,alt:e.fileName||"Galleri Bild",fill:!0,className:"object-cover rounded-md"})}),(0,l.jsx)("p",{className:"text-sm font-semibold truncate",children:(0,r.S)(e.fileName)}),t&&(0,l.jsx)(o,{imageId:e.id}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:["Uploaded: ",e.uploadedAt.toLocaleDateString()]}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:["Image by user: ",e.username||e.email||"Ghost user"]})]},e.id))})})}},26889:(e,s,t)=>{"use strict";t.d(s,{K:()=>i});var l=t(12115),r=t(35317),a=t(3586);let i=e=>{let[s,t]=(0,l.useState)([]),[i,n]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e)return void t([]);let s=(0,r.P)((0,r.rJ)(a.db,"images"),(0,r._M)("userId","==",e)),l=(0,r.aQ)(s,e=>{t(e.docs.map(e=>{var s;let t=e.data(),l=(null==(s=t.uploadedAt)?void 0:s.toDate)?t.uploadedAt.toDate():new Date;return{id:e.id,userId:t.userId,imageUrl:t.imageUrl,fileName:t.fileName,uploadedAt:l,email:t.email}}))},e=>{console.error("Error collecting images:",e),n("Could not load images")});return()=>l()},[e]),{images:s,error:i}}},62249:(e,s,t)=>{"use strict";t.d(s,{S:()=>l});let l=e=>{if(!e)return"";let s=e.lastIndexOf("."),t=e;return(s>0&&(t=e.substring(0,s)),0===t.length)?"":t.charAt(0).toUpperCase()+t.slice(1)}},68420:(e,s,t)=>{Promise.resolve().then(t.bind(t,73875))},73875:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var l=t(95155),r=t(6994),a=t(12115),i=t(68534),n=t(35695),d=t(19474);let o=e=>{let{ownImages:s}=e,t=(0,n.useRouter)();return s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,l.jsx)("h1",{children:"Welcome to the gallery!"}),(0,l.jsx)("p",{children:"You are currently browsing as a guest. Please sign up or sign in to view and comment on pictures."}),(0,l.jsx)(i.A,{variant:"outlined",onClick:()=>t.push("/sign-up"),children:"Sign Up"}),(0,l.jsx)(i.A,{variant:"outlined",onClick:()=>t.push("/sign-in"),children:"Sign In"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{children:"Here you can see your own pictures, if you have any uploaded"}),(0,l.jsxs)("h2",{children:["You can"," ",(0,l.jsx)(i.A,{variant:"outlined",onClick:()=>t.push("/sign-in"),children:"Upload"})," ","pictures here or sign in to get the full PicShare experience."]}),(0,l.jsx)(d.T,{images:s,showComments:!1})]})]}):(0,l.jsx)("div",{children:"Could not find users images"})};var c=t(3586),u=t(35317);let m=()=>{let[e,s]=(0,a.useState)([]),{user:t}=(0,r.A)();return(0,a.useEffect)(()=>{if(t){let e=(0,u.P)((0,u.rJ)(c.db,"images"),(0,u.My)("uploadedAt","desc")),t=(0,u.aQ)(e,e=>{s(e.docs.map(e=>{var s;let t=e.data(),l=(null==(s=t.uploadedAt)?void 0:s.toDate)?t.uploadedAt.toDate():new Date;return{id:e.id,userId:t.userId,imageUrl:t.imageUrl,fileName:t.fileName,uploadedAt:l,email:t.email,username:t.username}}))});return()=>t()}},[t]),{images:e}},h=()=>{let{images:e}=m();return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,l.jsx)("h1",{className:"text-[#1976D2] font-bold text-2xl",children:"Gallery"}),(0,l.jsxs)("div",{className:"px-8 w-full text-2xl pb-8",children:[(0,l.jsx)("p",{className:"mb-2",children:"Welcome to the Gallery! This is the place to explore and find new Pictures, users and comment!"}),(0,l.jsx)("p",{children:"Click on a Picture that looks interesting to see more and comment"})]}),(0,l.jsx)(d.T,{images:e,showComments:!0})]})})};var x=t(26889);let p=()=>{let{user:e}=(0,r.A)(),{images:s}=(0,x.K)(null==e?void 0:e.uid);return e?(null==e?void 0:e.isAnonymous)?(0,l.jsx)(o,{ownImages:s}):e?(0,l.jsx)(h,{}):(0,l.jsx)("div",{children:"Loading..."}):(0,l.jsx)("div",{children:"Could not find user"})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,163,577,766,112,441,684,358],()=>s(68420)),_N_E=e.O()}]);