(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{3586:(e,l,a)=>{"use strict";a.d(l,{I:()=>i,db:()=>o,j:()=>d});var t=a(16203),r=a(23915),n=a(35317),s=a(90858);let u=(0,r.Wp)({apiKey:"AIzaSyDLn-Qoqt0XSx9Fr7jdTqXt54rtzboGcUw",authDomain:"pic-share-be97b.firebaseapp.com",projectId:"pic-share-be97b",storageBucket:"pic-share-be97b.firebasestorage.app",messagingSenderId:"717613380259",appId:"1:717613380259:web:bc5443d92ec0ee76b20516",measurementId:"G-L1DP17QLDW"}),i=(0,s.c7)(u),o=(0,n.aU)(u),d=(0,t.xI)(u)},6994:(e,l,a)=>{"use strict";a.d(l,{A:()=>u});var t=a(12115),r=a(8731),n=a(35695),s=a(3586);let u=()=>{let[e,l]=(0,r.hD)(s.j),a=(0,n.useRouter)();return(0,t.useEffect)(()=>{let t=null==e?void 0:e.isAnonymous;l||e||!t||a.push("/sign-in")},[e,l,a]),{user:e,loading:l}}},38270:(e,l,a)=>{"use strict";a.d(l,{A:()=>u});var t=a(12115),r=a(35317),n=a(3586),s=a(6994);function u(){let[e,l]=(0,t.useState)(null),{user:a}=(0,s.A)();return(0,t.useEffect)(()=>{(async()=>{let e=null==a?void 0:a.uid,t=(null==a?void 0:a.email)||"";if(!e)return l(null);try{let a=(0,r.H9)(n.db,"users",e),s=await (0,r.x7)(a);s.exists()?l({email:t,...s.data()}):l({email:t})}catch(e){console.error("Error fetching user info: ",e),l(null)}})()},[a]),{userInfo:e}}},50963:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>p});var t=a(95155),r=a(12115),n=a(68534),s=a(3586),u=a(6994),i=a(35317),o=a(90858),d=a(38270),c=a(79251);let m=()=>{let[e,l]=(0,r.useState)(null),[a,t]=(0,r.useState)(!1),[n,m]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),{user:g}=(0,u.A)(),{user:h}=(0,c.q)(),{userInfo:b}=(0,d.A)(),x=(0,r.useCallback)(()=>{l(null),t(!1),m(null),p(null)},[]),v=(0,r.useCallback)(async()=>{if(!g&&!h)return void m("You were not able to upload the image. You are not logged in or a anonymous user.");let a=(null==g?void 0:g.uid)||(null==h?void 0:h.uid);if(!e)return void m("Please choose a file to upload.");t(!0),m(null),p(null);let r="images/".concat(a,"/").concat(e.name),n=(0,o.KR)(s.I,r);try{let l=await (0,o.D)(n,e),t=await (0,o.qk)(l.ref);p(t),await (0,i.gS)((0,i.rJ)(s.db,"images"),{userId:a,imageUrl:t,fileName:e.name,uploadedAt:(0,i.O5)(),email:(null==g?void 0:g.email)||"",username:(null==b?void 0:b.username)||""})}catch(e){console.error("Error uploading file:",e),m("Failed to upload: ".concat(e))}finally{t(!1),l(null)}},[e,g,h,b]);return{selectedFile:e,setSelectedFile:l,uploading:a,uploadError:n,downloadURL:f,handleUpload:v,resetUploadState:x}};var f=a(66766);let p=()=>{let{selectedFile:e,setSelectedFile:l,uploading:a,uploadError:r,downloadURL:s,handleUpload:u}=m();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center px-8 gap-4",children:[(0,t.jsx)("h1",{className:"text-[#1976D2] font-bold text-2xl",children:"Upload"}),(0,t.jsx)("input",{type:"file",className:"cursor-pointer border p-2 w-full",onChange:e=>{e.target.files&&e.target.files[0]&&l(e.target.files[0])}}),(0,t.jsx)(n.A,{variant:"outlined",onClick:u,disabled:!e||a,className:"text-black",children:a?"Uploading...":"Upload image"})]}),r&&(0,t.jsx)("p",{className:"text-red-600",children:r}),s&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Image uploaded successfully!"}),(0,t.jsx)("div",{className:"relative max-w-full h-auto mt-4 px-8",children:(0,t.jsx)(f.default,{src:s,alt:"Uploaded",fill:!0,className:"object-contain"})})]})]})}},52033:(e,l,a)=>{Promise.resolve().then(a.bind(a,50963))},79251:(e,l,a)=>{"use strict";a.d(l,{q:()=>s});var t=a(3586),r=a(16203),n=a(12115);let s=()=>{let[e,l]=(0,n.useState)({user:null,loading:!0,error:null});return(0,n.useEffect)(()=>{let e=(0,r.hg)(t.j,e=>{e?l({user:e,loading:!1,error:null}):(0,r.zK)(t.j).then(e=>{l({user:e.user,loading:!1,error:null})}).catch(e=>{console.error("Fel vid anonym inloggning:",e),l({user:null,loading:!1,error:"Kunde inte logga in anonymt."})})});return()=>e()},[]),e}}},e=>{var l=l=>e(e.s=l);e.O(0,[992,163,577,766,112,441,684,358],()=>l(52033)),_N_E=e.O()}]);