(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[522],{3586:(e,t,a)=>{"use strict";a.d(t,{I:()=>c,db:()=>d,j:()=>o});var s=a(16203),l=a(23915),r=a(35317),n=a(90858);let i=(0,l.Wp)({apiKey:"AIzaSyDLn-Qoqt0XSx9Fr7jdTqXt54rtzboGcUw",authDomain:"pic-share-be97b.firebaseapp.com",projectId:"pic-share-be97b",storageBucket:"pic-share-be97b.firebasestorage.app",messagingSenderId:"717613380259",appId:"1:717613380259:web:bc5443d92ec0ee76b20516",measurementId:"G-L1DP17QLDW"}),c=(0,n.c7)(i),d=(0,r.aU)(i),o=(0,s.xI)(i)},6994:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(12115),l=a(8731),r=a(35695),n=a(3586);let i=()=>{let[e,t]=(0,l.hD)(n.j),a=(0,r.useRouter)();return(0,s.useEffect)(()=>{let s=null==e?void 0:e.isAnonymous;t||e||!s||a.push("/sign-in")},[e,t,a]),{user:e,loading:t}}},38943:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(95155),l=a(12115),r=a(90044),n=a(68534),i=a(62249),c=a(35317),d=a(3586);let o=async(e,t,a,s)=>{try{let l=(0,c.rJ)(d.db,"images",e,"comments");await (0,c.gS)(l,{text:s,userId:t,email:a,createdAt:(0,c.O5)()})}catch(e){console.error("Error with comment",e)}},m=e=>{let[t,a]=(0,l.useState)([]);return(0,l.useEffect)(()=>{if(!e)return;let t=(0,c.rJ)(d.db,"images",e,"comments"),s=(0,c.P)(t,(0,c.My)("createdAt","asc")),l=(0,c.aQ)(s,e=>{a(e.docs.map(e=>{var t;let a=e.data(),s=(null==(t=a.createdAt)?void 0:t.toDate)?a.createdAt.toDate():new Date;return{id:e.id,text:a.text,userId:a.userId,email:a.email,createdAt:s}}))},e=>{console.error("Fel vid h\xe4mtning av kommentarer:",e)});return()=>l()},[e]),{comments:t}};var u=a(6994),x=a(35695);let h=e=>{let{comments:t}=e;return(0,s.jsx)("div",{className:"w-full py-4",children:0===t.length?(0,s.jsx)("p",{children:"No comment on this one, be the first one to comment!"}):t.map(e=>(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("p",{className:"text-s text-black",children:e.text}),(0,s.jsx)("p",{className:"text-s text-gray-500",children:e.email}),(0,s.jsx)("p",{className:"text-s text-gray-500",children:e.createdAt.toLocaleDateString()})]},e.id))})},f=e=>{let[t,a]=(0,l.useState)(null),[s,r]=(0,l.useState)(!0),[n,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{(async()=>{try{let s=(0,c.H9)(d.db,"images",e),l=await (0,c.x7)(s);if(l.exists()){var t;let e=l.data(),s=(null==(t=e.uploadedAt)?void 0:t.toDate)?e.uploadedAt.toDate():new Date;a({id:l.id,userId:e.userId,imageUrl:e.imageUrl,fileName:e.fileName,uploadedAt:s,email:e.email||"Unknown",username:e.username||"Unknown"})}else i("No image found")}catch(e){console.error("Error fetching image:",e),i("Could not load image")}finally{r(!1)}})()},[e]),{image:t,loading:s,error:n}};var p=a(66766);let g=e=>{let{params:t}=e,{imageId:a}=(0,l.use)(t),{comments:c}=m(a),{user:d}=(0,u.A)(),{image:g,loading:j,error:v}=f(a),[b,N]=(0,l.useState)(""),w=(0,x.useRouter)(),y=(null==d?void 0:d.email)||"",A=e=>{w.push("/users/".concat(e))};return j?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)("p",{children:"Loading image..."})}):v?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen text-red-500",children:(0,s.jsxs)("p",{children:["Fel: ",v]})}):g?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center px-8",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center w-full pt-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:(0,i.S)(g.fileName)}),(0,s.jsx)("div",{className:"relative max-w-full max-h-[50vh] h-auto mb-4 rounded-lg shadow-lg",children:(0,s.jsx)(p.default,{src:g.imageUrl,alt:g.fileName||"",fill:!0,className:"object-contain rounded-lg"})}),"Unknown"===g.email?(0,s.jsx)("p",{children:"Unknown"===g.username?g.email:g.username}):(0,s.jsx)(n.A,{variant:"outlined",onClick:()=>A(g.userId),children:"Unknown"===g.username?g.email:g.username}),(0,s.jsxs)("p",{className:"text-md text-gray-500 pt-2",children:["Uploaded at: ",g.uploadedAt.toLocaleDateString()]})]}),(0,s.jsx)(h,{comments:c}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 w-full pb-8",children:[(0,s.jsx)(r.A,{label:"Leave a comment on ".concat((0,i.S)(g.fileName)),value:b,onChange:e=>N(e.target.value),sx:{width:"100%"}}),(0,s.jsx)(n.A,{variant:"outlined",onClick:()=>{o(a,g.userId,y,b),N("")},sx:{width:"100%"},children:"Comment"})]})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)("p",{children:"Ingen bild att visa."})})}},39558:(e,t,a)=>{Promise.resolve().then(a.bind(a,38943))},62249:(e,t,a)=>{"use strict";a.d(t,{S:()=>s});let s=e=>{if(!e)return"";let t=e.lastIndexOf("."),a=e;return(t>0&&(a=e.substring(0,t)),0===a.length)?"":a.charAt(0).toUpperCase()+a.slice(1)}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,163,577,766,112,831,208,424,44,441,684,358],()=>t(39558)),_N_E=e.O()}]);