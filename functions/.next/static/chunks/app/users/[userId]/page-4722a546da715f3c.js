(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[652],{3586:(e,r,l)=>{"use strict";l.d(r,{I:()=>i,db:()=>n,j:()=>u});var t=l(16203),a=l(23915),s=l(35317),o=l(90858);let d=(0,a.Wp)({apiKey:"AIzaSyDLn-Qoqt0XSx9Fr7jdTqXt54rtzboGcUw",authDomain:"pic-share-be97b.firebaseapp.com",projectId:"pic-share-be97b",storageBucket:"pic-share-be97b.firebasestorage.app",messagingSenderId:"717613380259",appId:"1:717613380259:web:bc5443d92ec0ee76b20516",measurementId:"G-L1DP17QLDW"}),i=(0,o.c7)(d),n=(0,s.aU)(d),u=(0,t.xI)(d)},5589:(e,r,l)=>{"use strict";l.r(r),l.d(r,{default:()=>x});var t=l(95155),a=l(26889),s=l(3586),o=l(35317),d=l(12115);let i=e=>{let[r,l]=(0,d.useState)(null);return(0,d.useEffect)(()=>{(async()=>{try{let t=(0,o.H9)(s.db,"users",e),a=await (0,o.x7)(t);if(a.exists()){var r;let e=a.data(),t=(null==(r=e.createdAt)?void 0:r.toDate)?e.createdAt.toDate():new Date;l({userId:e.userId,createdAt:t,emailVerified:e.emailVerified,email:e.email||"Unknown",username:e.username||"Unknown"})}else console.error("Could not fetch user")}catch(e){console.error("Error fetching user:",e)}})()},[e]),{user:r}};var n=l(62249),u=l(35695),c=l(68534);let f=async(e,r)=>{try{let l=(0,o.rJ)(s.db,"followers");await (0,o.gS)(l,{followerId:e,followedId:r,createdAt:(0,o.O5)()})}catch(e){console.error("Error with follow",e)}};var m=l(6994);let h=(e,r)=>{let[l,t]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{if(!e||!r)return void t(!1);let l=(0,o.P)((0,o.rJ)(s.db,"followers"),(0,o._M)("followerId","==",e),(0,o._M)("followedId","==",r)),a=(0,o.aQ)(l,e=>{t(!e.empty)});return()=>a()},[e,r]),{isFollowing:l}},p=async(e,r)=>{try{let l=(0,o.P)((0,o.rJ)(s.db,"followers"),(0,o._M)("followerId","==",e),(0,o._M)("followedId","==",r)),t=await (0,o.GG)(l);if(t.empty)return console.error("Could not find a followers relation"),!1;{let e=t.docs[0];return await (0,o.kd)((0,o.H9)(s.db,"followers",e.id)),!0}}catch(e){return console.error("Error with unfollow",e),!1}};var w=l(66766);let x=e=>{let{params:r}=e,{userId:l}=(0,d.use)(r),{user:s}=i(l),{user:o}=(0,m.A)(),{images:x}=(0,a.K)(l),{isFollowing:g}=h(null==o?void 0:o.uid,l),b=(0,u.useRouter)();if(!o)return(0,t.jsx)("h1",{children:"Could not find personal user"});let v=async()=>{if(g)return void await p(o.uid,l);await f(o.uid,l)};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"w-full flex flex-col items-center justify-center",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold",children:[(null==s?void 0:s.username)==="Unknown"?null==s?void 0:s.email:null==s?void 0:s.username,"'s page"]}),(0,t.jsx)(c.A,{variant:"outlined",onClick:v,sx:{fontSize:"1rem"},children:g?"Unfollow":"Follow"}),(0,t.jsx)("h3",{className:"my-4 mx-8 text-2xl",children:"Here you can see all their uploaded pictures"}),x.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full max-w-5xl px-8",children:x.map(e=>(0,t.jsxs)("div",{className:"border p-2 rounded-lg shadow-md mb-8",onClick:()=>b.push("/gallery/".concat(e.id)),children:[(0,t.jsx)("div",{className:"relative w-full h-48 mb-2",children:(0,t.jsx)(w.default,{src:e.imageUrl,alt:e.fileName||"Galleri Bild",fill:!0,className:"object-cover rounded-md"})}),(0,t.jsx)("p",{className:"text-sm font-semibold truncate",children:(0,n.S)(e.fileName)}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Uploaded: ",e.uploadedAt.toLocaleDateString()]})]},e.id))}):(0,t.jsx)("p",{children:"This user have not yet uploaded to PicShare"})]})})}},6994:(e,r,l)=>{"use strict";l.d(r,{A:()=>d});var t=l(12115),a=l(8731),s=l(35695),o=l(3586);let d=()=>{let[e,r]=(0,a.hD)(o.j),l=(0,s.useRouter)();return(0,t.useEffect)(()=>{let t=null==e?void 0:e.isAnonymous;r||e||!t||l.push("/sign-in")},[e,r,l]),{user:e,loading:r}}},26889:(e,r,l)=>{"use strict";l.d(r,{K:()=>o});var t=l(12115),a=l(35317),s=l(3586);let o=e=>{let[r,l]=(0,t.useState)([]),[o,d]=(0,t.useState)(null);return(0,t.useEffect)(()=>{if(!e)return void l([]);let r=(0,a.P)((0,a.rJ)(s.db,"images"),(0,a._M)("userId","==",e)),t=(0,a.aQ)(r,e=>{l(e.docs.map(e=>{var r;let l=e.data(),t=(null==(r=l.uploadedAt)?void 0:r.toDate)?l.uploadedAt.toDate():new Date;return{id:e.id,userId:l.userId,imageUrl:l.imageUrl,fileName:l.fileName,uploadedAt:t,email:l.email}}))},e=>{console.error("Error collecting images:",e),d("Could not load images")});return()=>t()},[e]),{images:r,error:o}}},62249:(e,r,l)=>{"use strict";l.d(r,{S:()=>t});let t=e=>{if(!e)return"";let r=e.lastIndexOf("."),l=e;return(r>0&&(l=e.substring(0,r)),0===l.length)?"":l.charAt(0).toUpperCase()+l.slice(1)}},97776:(e,r,l)=>{Promise.resolve().then(l.bind(l,5589))}},e=>{var r=r=>e(e.s=r);e.O(0,[992,163,577,766,112,441,684,358],()=>r(97776)),_N_E=e.O()}]);