(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{3586:(e,l,t)=>{"use strict";t.d(l,{I:()=>i,db:()=>n,j:()=>u});var s=t(16203),r=t(23915),a=t(35317),o=t(90858);let d=(0,r.Wp)({apiKey:"AIzaSyDLn-Qoqt0XSx9Fr7jdTqXt54rtzboGcUw",authDomain:"pic-share-be97b.firebaseapp.com",projectId:"pic-share-be97b",storageBucket:"pic-share-be97b.firebasestorage.app",messagingSenderId:"717613380259",appId:"1:717613380259:web:bc5443d92ec0ee76b20516",measurementId:"G-L1DP17QLDW"}),i=(0,o.c7)(d),n=(0,a.aU)(d),u=(0,s.xI)(d)},6994:(e,l,t)=>{"use strict";t.d(l,{A:()=>d});var s=t(12115),r=t(8731),a=t(35695),o=t(3586);let d=()=>{let[e,l]=(0,r.hD)(o.j),t=(0,a.useRouter)();return(0,s.useEffect)(()=>{let s=null==e?void 0:e.isAnonymous;l||e||!s||t.push("/sign-in")},[e,l,t]),{user:e,loading:l}}},19474:(e,l,t)=>{"use strict";t.d(l,{T:()=>m});var s=t(95155),r=t(62249),a=t(12115),o=t(35317),d=t(3586);let i=async e=>{if(!e)return 0;let l=(0,o.rJ)(d.db,"images",e,"comments");return(await (0,o.GG)(l)).size},n=e=>{let{imageId:l}=e,[t,r]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{i(l).then(r),null!==t&&t>1&&d(!0)},[l,t]),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:null!==t?"".concat(t," ").concat(o?"comments":"comment"):"Loading..."})};var u=t(35695),c=t(66766);let m=e=>{let{images:l,showComments:t}=e,a=(0,u.useRouter)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full max-w-5xl px-8 cursor-pointer",children:l.map(e=>(0,s.jsxs)("div",{className:"border p-2 rounded-lg shadow-md mb-8",onClick:()=>a.push("/gallery/".concat(e.id)),children:[(0,s.jsx)("div",{className:"relative w-full h-48 mb-2",children:(0,s.jsx)(c.default,{src:e.imageUrl,alt:e.fileName||"Galleri Bild",fill:!0,className:"object-cover rounded-md"})}),(0,s.jsx)("p",{className:"text-sm font-semibold truncate",children:(0,r.S)(e.fileName)}),t&&(0,s.jsx)(n,{imageId:e.id}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Uploaded: ",e.uploadedAt.toLocaleDateString()]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Image by user: ",e.username||e.email||"Ghost user"]})]},e.id))})})}},62249:(e,l,t)=>{"use strict";t.d(l,{S:()=>s});let s=e=>{if(!e)return"";let l=e.lastIndexOf("."),t=e;return(l>0&&(t=e.substring(0,l)),0===t.length)?"":t.charAt(0).toUpperCase()+t.slice(1)}},82802:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>f});var s=t(95155),r=t(6994),a=t(3586),o=t(35317),d=t(12115);let i=e=>{let[l,t]=(0,d.useState)(null);return(0,d.useEffect)(()=>{if(!e)return void t(null);let l=(0,o.P)((0,o.rJ)(a.db,"followers"),(0,o._M)("followerId","==",e)),s=(0,o.aQ)(l,async e=>{let l=e.docs.map(async e=>{var l;let t,s,r,d=e.data(),i=d.followedId,n=(0,o.H9)(a.db,"users",i),u=await (0,o.x7)(n);if(u.exists()){let e=u.data();t=e.username,s=e.email,r=e.emailVerified}let c=(null==(l=d.createdAt)?void 0:l.toDate)?d.createdAt.toDate():new Date;return{id:e.id,createdAt:c,followedId:d.followedId,followerId:d.followerId,followedUserUsername:t,followedUserEmail:s,followedUserEmailVerified:r}});t(await Promise.all(l))},e=>{console.error("Error fetching followed users:",e),t([])});return()=>s()},[e]),{followedUsers:l}};var n=t(68534),u=t(35695),c=t(19474);let m=e=>{let[l,t]=(0,d.useState)([]);return(0,d.useEffect)(()=>{if(!e||0===e.length)return void t([]);let l=(0,o.P)((0,o.rJ)(a.db,"images"),(0,o._M)("userId","in",e)),s=(0,o.aQ)(l,e=>{let l=e.docs.map(e=>{let l=e.data(),t=l.uploadedAt.toDate?l.uploadedAt.toDate():new Date;return{id:e.id,userId:l.userId,imageUrl:l.imageUrl,fileName:l.fileName,uploadedAt:t,email:l.email,username:l.username}});l.sort((e,l)=>l.uploadedAt.getTime()-e.uploadedAt.getTime()),t(l)},e=>{console.error("Error collecting followed users images: ",e)});return()=>s()},[e]),{followedUsersImages:l}},f=()=>{let{user:e}=(0,r.A)(),l=(0,u.useRouter)(),{followedUsers:t}=i(null==e?void 0:e.uid),{followedUsersImages:a}=m((0,d.useMemo)(()=>t?t.map(e=>e.followedId):[],[t]));return t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"w-full flex flex-col justify-center items-center px-8",children:[(0,s.jsx)("h1",{className:"text-[#1976D2] font-bold text-2xl",children:"Feed"}),(0,s.jsx)("p",{className:"w-full text-2xl pb-8",children:"Welcome to the Feed! This is the place to see all the pictures uploaded from people you follow!"})]}),(0,s.jsx)(c.T,{images:a,showComments:!0}),(0,s.jsxs)("div",{className:"w-full flex flex-col justify-center items-center p-8 text-2xl",children:[(0,s.jsx)("p",{className:"mb-4",children:"Head over to users if you want to find more people to follow!"}),(0,s.jsx)(n.A,{variant:"outlined",onClick:()=>l.push("/users"),sx:{color:"#E38724",fontSize:"1.5rem"},children:"Users"})," "]})]}):(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:["You have no feed since you have not followed anyone yet. ",(0,s.jsx)("br",{})," Check out"," ",(0,s.jsx)(n.A,{variant:"outlined",onClick:()=>l.push("/users"),children:"Users"})," ","to see our verified users and begin to follow some!"]})})}},90876:(e,l,t)=>{Promise.resolve().then(t.bind(t,82802))}},e=>{var l=l=>e(e.s=l);e.O(0,[992,163,577,766,112,441,684,358],()=>l(90876)),_N_E=e.O()}]);